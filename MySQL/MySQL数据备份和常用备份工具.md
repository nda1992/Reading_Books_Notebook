# MySQL数据备份、恢复和常用备份工具

> 数据备份是DBA日常最重要的工作之一，如何保证数据丢失后能恢复到事故之前，数据的备份是其中重要的一步.
>
> 同时，数据备份不是最终的目的，而数据恢复才是最终的目的.

### 数据备份的注意事项

- 最多能容忍多少数据丢失
- 数据恢复需要多长的时间完成
- 需要恢复的数据有哪些
- 备份时服务器的可以承受的负载
- 定期测试备份的可用性，并提高恢复操作的效率
- 锁定资源的时长



### 备份的类型

- 涉及的数据范围

```
完全备份：整个数据集

部分备份：数据的一个子集，如某些表
```

- 数据的变化

```
完全备份：整个范围都备份

增量备份：仅备份上一次完全备份或增量备份以来变化的那部分数据

差异备份：仅备份上一次完全备份以来的变化的那部分数据
```

- 按操作对象分类

```
物理备份：直接从磁盘复制数据文件进行备份

逻辑备份：从数据库导出数据，另存到一个或多个文件中，将数据转换为具体的SQL语句
```

- 按照服务器备份时的运行状态分类

```
热备：读写操作均可进行的状态下所做的备份

温备：可读但不可写的状态下进行备份

冷备：读写操作均不可进行的状态下所做的备份
```

### 备份的策略

```
（binlogs是MySQL中最重要的日志之一，它记录了所有的DDL和DML语句（除了查询之外）），因此可以考虑将数据与二进制日志分开存放，并对二进制日志也进行备份

全量+差异+binlogs

全量+增量+binlogs
```





### MySQL备份工具

- mysqldump

```
mysql服务自带的备份工具，它是一个逻辑备份工具，本质是将数据库转换为可执行的sql脚本，可用来做完全备份和部分备份，支持InnoDB存储引擎的热备功能，支持MyISAM存储引擎的温备功能


系统自带的cp/tar工具：这是一种物理备份，它的原理是基于快照时间，快照请求一个全局锁之后将会立即释放，达到热备的效果，但是不能仅仅备份数据，还要同时备份事务日志，并且要求数据和日志在同一个逻辑卷内

xtrabackup：由Percona开发的开源备份工具，支持InnoDB热备、物理备份工具
```



### trabackup备份工具

- 组成

```
两个主要工具：
（1）xtrabackup
只能备份InnoDB和XtraDB两种数据表，不能备份MyISAM的数据表

（2）innobackupex
封装了xtrabackup，同时支持InnoDB和MyISAM（处理MyISAM时需要添加一个读的锁）
```























